!function(){"use strict";angular.module("myApp",["ui.router"])}(),function(){"use strict";angular.module("myApp").config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/"),a.state("list",{url:"/",views:{main:{controller:"mainController",templateUrl:"partials/list-view.html"}}}).state("addToList",{url:"/add-new",views:{main:{controller:"mainController",templateUrl:"partials/list-view.html"},modal:{controller:"newAppartmentController",templateUrl:"partials/new.modal.html"}}})}])}(),function(){"use strict";angular.module("myApp").factory("demographic",function(){return{cities:["eilat","ashdod","ashkelon","beer sheva","beit shean","zichron yaakov","hadera","haifa","tveria","jerusalem","lod","metula","naharia","natzrat","netanya","sdom","ein gedi","afula","arad","petach tikva","tzfat","rehovot","ramla","tel aviv"],streets:["Arlozorov","Weizmann","Nordow","Katzanelson","Namir"]}})}(),function(){"use strict";angular.module("myApp").factory("features",function(){return["air condition","parking","elevator","mamad","furnished","running water"]})}(),function(){"use strict";angular.module("myApp").factory("filterStore",function(){function a(a,b){return b.every(function(b){return a.indexOf(b)>=0})}var b=this;return{rangeCompare:function(b,c){return angular.isArray(c)?0===c.length||a(b,c):b>=c.from&&b<=c.to},filterBase:function(){return b.filterBase},filterAdvanced:function(){return b.filterAdvanced},reset:function(){b.filterBase={},b.filterAdvanced={};for(var a in b.possibleRangeValues)"features"!==a&&(b.filterAdvanced[a]={},b.filterAdvanced[a].from=b.possibleRangeValues[a].min,b.filterAdvanced[a].to=b.possibleRangeValues[a].max);b.filterAdvanced.features=[]},getPossibleRangeValues:function(){return b.possibleRangeValues},setFilterValues:function(a){b.possibleRangeValues=a}}})}(),function(){"use strict";angular.module("myApp").factory("rentalsFactory",["demographic","features",function(a,b){var c=0,d=[{city:a.cities[0],street:a.streets[0],rooms:3,price:3e3,features:[b[0],b[1],b[2]]},{city:a.cities[1],street:a.streets[1],rooms:3,price:4e3,features:[b[2]]},{city:a.cities[2],street:a.streets[0],rooms:2,price:3e3,features:[b[1],b[2]]},{city:a.cities[3],street:a.streets[0],rooms:5,price:2500,features:[b[2],b[3],b[4],b[5]]},{city:a.cities[3],street:a.streets[3],rooms:4,price:3500,features:[b[2],b[3],b[4],b[5]]},{city:a.cities[2],street:a.streets[1],rooms:7,price:7e3,features:[b[3],b[5]]}];return angular.forEach(d,function(a){a.id=c++}),{appartments:d,addAppartment:function(a){a.id=c++,d.push(a)},removeById:function(a){console.log("removeById called with ",a)}}}])}(),function(){"use strict";angular.module("myApp").controller("filterController",["$scope","rentalsFactory","filterStore","$window",function(a,b,c,d){function e(){c.setFilterValues(f())}function f(){var a=[],b=[],c=[];return angular.forEach(h,function(d){a.push(d.rooms),b.push(d.price),angular.forEach(d.features,function(a){-1===c.indexOf(a)&&c.push(a)})}),{rooms:{min:d.Math.min.apply(d.Math,a),max:d.Math.max.apply(d.Math,a)},price:{min:d.Math.min.apply(d.Math,b),max:d.Math.max.apply(d.Math,b)},features:c}}function g(){c.reset()}var h=b.appartments;a.$watch(function(){return h.length},e),a.toggleSelection=function(b){var c=a.filterAdvanced.features.indexOf(b);c>-1?a.filterAdvanced.features.splice(c,1):a.filterAdvanced.features.push(b)},e(),g(),a.$watch(c.getPossibleRangeValues,function(b){a.filterValues=b},!0),a.filterBase=c.filterBase(),a.filterAdvanced=c.filterAdvanced()}])}(),function(){"use strict";angular.module("myApp").controller("mainController",["$scope","rentalsFactory","filterStore","$window","$filter",function(a,b,c,d,e){function f(a){return e("filter")(e("filter")(a,c.filterBase()),c.filterAdvanced(),c.rangeCompare)}var g=b.appartments;a.matchedRentals=g,a.editMode={on:!1},a.activateEdit=function(){a.editMode.on=!0},a.template_url="partials/appartment.html",a.removeById=b.removeById,a.$watch(function(){return g},function(){a.matchedRentals=f(g)},!0),a.$watch(function(){return angular.extend({},c.filterBase(),c.filterAdvanced())},function(b,c){b&&!angular.equals(b,c)&&(a.matchedRentals=f(g))},!0)}])}(),function(){"use strict";angular.module("myApp").controller("newAppartmentController",["$scope","$state","features","rentalsFactory","$window",function(a,b,c,d){a.features=angular.copy(c),a.newEntry={features:[]},a.toggleSelection=function(b){var c=a.newEntry.features.indexOf(b);c>-1?a.newEntry.features.splice(c,1):a.newEntry.features.push(b)},a.close=function(){b.go("list")},a.addAppartment=function(b){d.addAppartment(b),a.newEntry={features:[]},a.close()}}])}(),function(){"use strict";angular.module("myApp").directive("slider",function(){return{restrict:"EA",scope:{min:"@",max:"@",step:"@",type:"@",trigger:"@",orientation:"@",from:"=",to:"=",value:"="},link:function(a,b){function c(b,c){a.$apply(function(){"range"==a.type?(a.from=c.values[0],a.to=c.values[1]):a.value=c.value})}var d=$(b).slider();angular.forEach(["min","max","step","value"],function(b){a.$watch(b,function(a){angular.isNumber(a)||(a=parseFloat(a)),angular.isNumber&&d.slider("option",b,parseFloat(a))})}),a.$watchCollection("[from, to]",function(a){d.slider("option","values",a)}),a.$watch("orientation",function(a){var c=d.slider("option");c.orientation=a||"horizontal",d.slider("destroy"),d=$(b).slider(c)}),a.$watch("trigger",function(a){"change"==a?(d.slider("option","slide",null),d.slider("option","change",c)):(d.slider("option","change",null),d.slider("option","slide",c))}),a.$watch("type",function(a){var e=d.slider("option");switch(e.slide||e.change||(e.slide=c),isNaN(e.step)&&(e.step=1),a){case"from":e.range&&"min"!=e.range&&"max"!=e.range&&e.values&&(e.value=e.values[0]),e.values=null,e.range="max";break;case"to":e.range&&"min"!=e.range&&"max"!=e.range&&e.values&&(e.value=e.values[1]),e.values=null,e.range="min";break;case"range":"max"==e.range?e.values=[e.value,e.max]:"min"==e.range?e.values=[e.min,e.value]:e.range||angular.isArray(e.values)&&2==e.values.length||(e.values=[e.min,e.max]),e.value=null,e.range=!0;break;default:e.range&&"min"!=e.range&&"max"!=e.range&&e.values&&(e.value=e.values[0]),e.values=null,e.range=!1}d.slider("destroy"),d=$(b).slider(e)})}}})}();